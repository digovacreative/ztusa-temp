<?php
function load_checkoutstep_function(){  
    if($_POST['process'] === 'both'){ 
        $totalSteps=5; 
        $donation_type='both';
        $stepThree = 'One Off'; 
    }elseif($_POST['process'] === 'recurring'){ 
        $totalSteps=4;
        $donation_type='recurring';
        $stepThree = 'Recurring';
    }else{ 
        $donation_type='single';
        $totalSteps=4; $stepThree = 'One Off'; 
    }

    $current_step = $_POST['step'];

    switch ($current_step) {
        case 1:
            $message = '1. Select Cause';
            $process = 'step_1_'.$totalSteps;
            $scrollTo = '.mainContent';
            $active = array(1);
            break;
        case 2:
            $message = '2. Select Amount';
            $process = 'step_2_'.$totalSteps;
            $scrollTo = '#product_details_box';
            $active = array(1,2);
            break;
        case 3:
            $message = '3. '.$stepThree.' Donation Checkout';
            $process = 'step_3_'.$totalSteps;
            $scrollTo = '#checkout_page';
                if($donation_type==='recurring'):
                    $active = array(1,2,3,4);
                else:
                    $active = array(1,2,3);
                endif;
            break;
        case 4:
            $message = '4. Regular Donation Checkout';
            $process = 'step_4_'.$totalSteps;
            $scrollTo = '#recurring_checkout_page';
            $active = array(1,2,3,4);
            break;
        case 'complete':
            $message = 'Completed';
            $process = 'step_full';
            $scrollTo = '.completed';
            $active = array(1,2,3,4,5);
            break;
    }

    ?>
    <div class="checkout_steps">
        <ul>
            <li class="width_<?php echo $totalSteps; ?> <?php if(in_array("1", $active)): echo 'active'; endif; ?>">
                <i>
                    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#666;}</style></defs><title/><g data-name="18" id="_18"><path class="cls-1" d="M48.5,47.5H47V14a1.5,1.5,0,0,0-1.5-1.5H39A2.5,2.5,0,0,0,36.5,10H33.951a3.484,3.484,0,0,0-6.9,0H24.5A2.5,2.5,0,0,0,22,12.5H15.5A1.5,1.5,0,0,0,14,14V54.5A1.5,1.5,0,0,0,15.5,56h30A1.5,1.5,0,0,0,47,54.5v-2h1.5a2.5,2.5,0,0,0,0-5Zm-24.073,4a.5.5,0,0,1-.224-.053L21.31,50,24.2,48.554a.494.494,0,0,1,.225-.054H46v3ZM30.5,8a2.5,2.5,0,0,1,2.449,2h-4.9A2.5,2.5,0,0,1,30.5,8ZM23,12.5A1.5,1.5,0,0,1,24.5,11h12A1.5,1.5,0,0,1,38,12.5V15h0v0H23Zm-7.5,1H22V15a1,1,0,0,0,1,1H38a1,1,0,0,0,1-1V13.5h6.5a.5.5,0,0,1,.5.5v3.5H15V14A.5.5,0,0,1,15.5,13.5ZM45.5,55h-30a.5.5,0,0,1-.5-.5v-36H46v29H24.427a1.524,1.524,0,0,0-.671.158l-3.34,1.671a.75.75,0,0,0,0,1.342l3.342,1.672a1.529,1.529,0,0,0,.67.157H46v2A.5.5,0,0,1,45.5,55Zm3-3.5H47v-3h1.5a1.5,1.5,0,0,1,0,3Z"/><path class="cls-1" d="M24.5,44.25h12a.5.5,0,0,0,0-1h-12a.5.5,0,0,0,0,1Z"/><path class="cls-1" d="M24.5,41.25h12a.5.5,0,0,0,0-1h-12a.5.5,0,0,0,0,1Z"/><path class="cls-1" d="M24.5,38.25h12a.5.5,0,0,0,0-1h-12a.5.5,0,0,0,0,1Z"/><path class="cls-1" d="M27.5,35.25h6a.5.5,0,0,0,0-1h-6a.5.5,0,0,0,0,1Z"/><path class="cls-1" d="M30.493,32a1.341,1.341,0,0,1-.955-.4h0l-4.045-4.076a3.283,3.283,0,0,1-.513-4.046,3.159,3.159,0,0,1,4.923-.543l.59.593.467-.471a3.316,3.316,0,0,1,2.53-1,3.035,3.035,0,0,1,2.223,1.036,3.2,3.2,0,0,1-.143,4.358L31.448,31.6A1.343,1.343,0,0,1,30.493,32Zm-.245-1.1a.351.351,0,0,0,.49,0l4.123-4.153a2.2,2.2,0,0,0,.1-3,2.047,2.047,0,0,0-1.5-.693,2.4,2.4,0,0,0-1.787.711l-.822.829a.515.515,0,0,1-.71,0l-.945-.951a2.158,2.158,0,0,0-3.371.378,2.275,2.275,0,0,0,.381,2.8Z"/></g></svg>
                </i>
                <strong>Select Cause</strong>
            </li>
            <li class="width_<?php echo $totalSteps; ?> <?php if(in_array("2", $active)): echo 'active'; endif; ?>">
                <i>
                    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#666;}</style></defs><title/><g data-name="16" id="_16"><path class="cls-1" d="M50.5,38.051v-12.1a3.989,3.989,0,1,0-3.684-6.344L36.192,13.533a4,4,0,1,0-7.384,0L18.184,19.605A3.988,3.988,0,1,0,14.5,25.949v12.1A3.989,3.989,0,1,0,18.184,44.4l10.624,6.072a4,4,0,1,0,7.384,0L46.816,44.4A3.988,3.988,0,1,0,50.5,38.051ZM50,19a3,3,0,1,1-3,3A3,3,0,0,1,50,19ZM32.5,9a3,3,0,1,1-3,3A3,3,0,0,1,32.5,9ZM12,22a3,3,0,1,1,3,3A3,3,0,0,1,12,22Zm3,23a3,3,0,1,1,3-3A3,3,0,0,1,15,45ZM32.5,55a3,3,0,1,1,3-3A3,3,0,0,1,32.5,55Zm3.184-5.4a3.961,3.961,0,0,0-6.368,0L18.692,43.533A3.976,3.976,0,0,0,15.5,38.051v-12.1a3.976,3.976,0,0,0,3.192-5.482L29.316,14.4a3.961,3.961,0,0,0,6.368,0l10.624,6.072A3.976,3.976,0,0,0,49.5,25.949v12.1a3.976,3.976,0,0,0-3.192,5.482ZM50,45a3,3,0,1,1,3-3A3,3,0,0,1,50,45Z"/><path class="cls-1" d="M32.5,20.5A11.5,11.5,0,1,0,44,32,11.513,11.513,0,0,0,32.5,20.5Zm0,22A10.5,10.5,0,1,1,43,32,10.512,10.512,0,0,1,32.5,42.5Z"/><path class="cls-1" d="M36.034,27.313a3.984,3.984,0,0,0-2.923,1.147l-.619.616-.764-.759a3.668,3.668,0,0,0-5.673.62,3.717,3.717,0,0,0,.594,4.622l4.781,4.754a1.508,1.508,0,0,0,2.123,0l4.873-4.846a3.623,3.623,0,0,0,.164-4.976A3.524,3.524,0,0,0,36.034,27.313Zm1.687,5.445L32.848,37.6a.506.506,0,0,1-.713,0h0L27.354,32.85a2.715,2.715,0,0,1-.46-3.369,2.667,2.667,0,0,1,4.128-.455l1.117,1.11a.5.5,0,0,0,.7,0l.972-.967A2.917,2.917,0,0,1,36,28.313a2.529,2.529,0,0,1,1.84.84,2.623,2.623,0,0,1-.119,3.605Z"/></g></svg>
                </i>
                <strong>Select Amount</strong>
            </li>
            <?php if( ($donation_type==='single') || ($donation_type==='both')): ?>
            <li class="width_<?php echo $totalSteps; ?> <?php if(in_array("3", $active)): echo 'active'; endif; ?>">
                <i>
                    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#666;}</style></defs><title/><g data-name="14" id="_14"><path class="cls-1" d="M46.989,40.766A13.329,13.329,0,0,0,33.67,28H31.33A13.329,13.329,0,0,0,18.011,40.764c-.011.209-.011.406-.011.614v5a2.519,2.519,0,0,0,1.66,2.36h0L30.126,52.47l.94.94a2,2,0,0,0,2.836,0l.93-.924L45.34,48.738A2.519,2.519,0,0,0,47,46.378v-5C47,41.17,47,40.973,46.989,40.766ZM33.2,52.7a1.023,1.023,0,0,1-1.389.032l.012-.006a1.651,1.651,0,0,0,.469-.235A1.7,1.7,0,0,0,33,51.118a1.675,1.675,0,0,0-.725-1.381L23.427,43.6a4.09,4.09,0,0,1,.453-3.386,4.22,4.22,0,0,1,3.576-1.961,4.289,4.289,0,0,1,3,1.234l1.681,1.67a.5.5,0,0,0,.705,0L34.3,39.7a4.694,4.694,0,0,1,3.448-1.361A4.037,4.037,0,0,1,40.7,39.69a4.193,4.193,0,0,1,.775,1.283,4.29,4.29,0,0,1,.279,1.483c0,.109-.025.212-.033.319a4.217,4.217,0,0,1-.683,2.023,4.123,4.123,0,0,1-.526.636L34.2,51.7c-.005.006-.008.014-.013.02ZM46,46.378A1.5,1.5,0,0,1,45,47.8L36.5,50.831l4.715-4.688a5.2,5.2,0,0,0,1.538-3.681v-.009a5.225,5.225,0,0,0-1.3-3.424,5.021,5.021,0,0,0-3.662-1.687A5.7,5.7,0,0,0,33.6,38.994l-1.108,1.1-1.329-1.32a5.251,5.251,0,0,0-8.12.894,5.105,5.105,0,0,0-.517,4.4.514.514,0,0,0,.191.254l8.992,6.241a.676.676,0,0,1,.293.558.7.7,0,0,1-.3.564.668.668,0,0,1-.621.068l-.48-.171-.031-.011h0L20,47.8a1.5,1.5,0,0,1-1-1.419v-5c0-.192,0-.374.009-.567A12.332,12.332,0,0,1,31.33,29h2.34A12.333,12.333,0,0,1,45.991,40.813c.009.191.009.373.009.565Z"/><path class="cls-1" d="M32.5,26A8.5,8.5,0,1,0,24,17.5,8.51,8.51,0,0,0,32.5,26Zm0-16A7.5,7.5,0,1,1,25,17.5,7.508,7.508,0,0,1,32.5,10Z"/></g></svg>
                </i>
                <strong>Single Checkout</strong>
            </li>
            <?php endif; ?>

            <?php if( ($donation_type==='recurring') || ($donation_type==='both')): ?>
            <li class="width_<?php echo $totalSteps; ?> <?php if(in_array("4", $active)): echo 'active'; endif; ?>">
                <i>
                    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#666;}</style></defs><title/><g data-name="13" id="_13"><path class="cls-1" d="M53.893,39.34A8.826,8.826,0,0,0,45.21,32.1h-.87a8.88,8.88,0,0,0-3.3.653,10.088,10.088,0,0,0-7.661-3.5h-1.75a10.094,10.094,0,0,0-7.662,3.5,8.894,8.894,0,0,0-3.3-.652h-.87a8.819,8.819,0,0,0-8.678,7.224A5.746,5.746,0,0,0,11,40.1a.489.489,0,0,0,.026.2,1.394,1.394,0,0,0,.914.867l10.89,3.88.013,0,8.276,2.956a4.062,4.062,0,0,0,2.754,0l8.283-2.957.01,0,10.876-3.875a1.408,1.408,0,0,0,.929-.872A.5.5,0,0,0,54,40.1,5.635,5.635,0,0,0,53.893,39.34Zm-41.883.711a4.354,4.354,0,0,1,.082-.531,7.826,7.826,0,0,1,7.7-6.421h.87a7.9,7.9,0,0,1,2.667.476A10.117,10.117,0,0,0,21.51,38.94c-.009.16-.01.309-.01.468v3.755a1.934,1.934,0,0,0,.059.373l-9.3-3.311A.469.469,0,0,1,12.01,40.051ZM33.535,47.07a3.071,3.071,0,0,1-2.074,0l-8.3-2.963a1.006,1.006,0,0,1-.664-.943V39.408c0-.139,0-.269.008-.416a9.12,9.12,0,0,1,9.117-8.742h1.75A9.12,9.12,0,0,1,42.492,39c.008.14.008.27.008.409v3.755a1.006,1.006,0,0,1-.663.943Zm19.187-6.84-9.28,3.306a2.013,2.013,0,0,0,.058-.373V39.408c0-.159,0-.308-.01-.461a10.127,10.127,0,0,0-1.818-5.372A7.9,7.9,0,0,1,44.34,33.1h.87a7.832,7.832,0,0,1,7.7,6.436,4.513,4.513,0,0,1,.078.516A.487.487,0,0,1,52.722,40.23Z"/><path class="cls-1" d="M36.034,34.563A3.99,3.99,0,0,0,33.11,35.71l-.619.616-.764-.759a3.65,3.65,0,1,0-5.079,5.242l4.781,4.754a1.509,1.509,0,0,0,2.124,0l4.873-4.846a3.625,3.625,0,0,0,.165-4.976A3.526,3.526,0,0,0,36.034,34.563Zm1.687,5.445-4.874,4.846a.5.5,0,0,1-.713,0h0L27.353,40.1a2.713,2.713,0,0,1-.461-3.369,2.668,2.668,0,0,1,4.129-.455l1.117,1.11a.5.5,0,0,0,.705,0l.973-.967A2.886,2.886,0,0,1,36,35.563a2.533,2.533,0,0,1,1.84.839,2.625,2.625,0,0,1-.12,3.606Z"/><path class="cls-1" d="M44.75,31.25a4.875,4.875,0,1,0-4.875-4.875A4.88,4.88,0,0,0,44.75,31.25Zm0-8.75a3.875,3.875,0,1,1-3.875,3.875A3.879,3.879,0,0,1,44.75,22.5Z"/><path class="cls-1" d="M20.25,31.25a4.875,4.875,0,1,0-4.875-4.875A4.881,4.881,0,0,0,20.25,31.25Zm0-8.75a3.875,3.875,0,1,1-3.875,3.875A3.879,3.879,0,0,1,20.25,22.5Z"/><path class="cls-1" d="M32.5,28.25a6.625,6.625,0,1,0-6.625-6.625A6.633,6.633,0,0,0,32.5,28.25ZM32.5,16a5.625,5.625,0,1,1-5.625,5.625A5.631,5.631,0,0,1,32.5,16Z"/></g></svg>
                </i>
                <strong>Regular Checkout</strong>
            </li>
            <?php endif; ?>

            <li class="width_<?php echo $totalSteps; ?> <?php if(in_array("5", $active)): echo 'active'; endif; ?>">
                <i>
                    <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg"><defs><style>.cls-1{fill:#666;}</style></defs><title/><g data-name="17" id="_17"><path class="cls-1" d="M46.5,29H34.423a.5.5,0,0,1-.466-.68l2.234-5.8a2.474,2.474,0,0,0,.176-.936A2.583,2.583,0,0,0,33.787,19a2.555,2.555,0,0,0-1.975.921l-7.628,9.193a2.5,2.5,0,0,1-1.91.886H19v-.5A1.5,1.5,0,0,0,17.5,28h-3A1.5,1.5,0,0,0,13,29.5v17A1.5,1.5,0,0,0,14.5,48h3A1.5,1.5,0,0,0,19,46.5V46H40.007a3.5,3.5,0,0,0,3.109-1.88L48.71,32.672A2.5,2.5,0,0,0,46.5,29ZM18,46.5a.5.5,0,0,1-.5.5h-3a.5.5,0,0,1-.5-.5v-17a.5.5,0,0,1,.5-.5h3a.5.5,0,0,1,.5.5ZM47.818,32.221,42.225,43.668A2.5,2.5,0,0,1,40.007,45H19V31h3.274a3.5,3.5,0,0,0,2.677-1.244l7.631-9.2a1.555,1.555,0,0,1,1.2-.56,1.582,1.582,0,0,1,1.58,1.58,1.482,1.482,0,0,1-.107.57l-2.237,5.811A1.5,1.5,0,0,0,34.423,30H46.5a1.488,1.488,0,0,1,1.282.721A1.511,1.511,0,0,1,47.818,32.221Z"/><path class="cls-1" d="M51.09,16.241a3.524,3.524,0,0,0-2.556-1.178,3.987,3.987,0,0,0-2.923,1.147l-.619.616-.764-.759a3.668,3.668,0,0,0-5.673.62,3.717,3.717,0,0,0,.594,4.622l4.781,4.754a1.508,1.508,0,0,0,2.123,0l4.873-4.846a3.623,3.623,0,0,0,.164-4.976Zm-.869,4.267-4.873,4.846a.5.5,0,0,1-.713,0h0L39.854,20.6a2.715,2.715,0,0,1-.46-3.369,2.667,2.667,0,0,1,4.128-.455l1.117,1.11a.5.5,0,0,0,.7,0l.972-.967a2.941,2.941,0,0,1,2.184-.856,2.529,2.529,0,0,1,1.84.84,2.623,2.623,0,0,1-.119,3.605Z"/></g></svg>    
                </i>
                <strong>Completed</strong>
            </li>
            
        </ul>
        <span class="progress <?php echo $process; ?>"></span>
    </div>
    <script type="text/javascript">
        jQuery('.progress').removeClass('active');
        setTimeout( function() {
            jQuery('.progress').addClass('active');
            jQuery([document.documentElement, document.body]).animate({
                scrollTop: jQuery("<?php echo $scrollTo; ?>").offset().top
            }, 100);
            
        }, 200);
    </script>
    <?php
    die();
}
add_action('ZTRUST_AJAX_loadstep', 'load_checkoutstep_function');
add_action('ZTRUST_AJAX_nopriv_loadstep', 'load_checkoutstep_function');
?>